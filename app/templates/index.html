{% extends "base.html" %}

{% block role %}
<div id="roleData" data-my-variable="{{ role }}"></div>
{% endblock %}

{% block content %}
<br><br>

<h2>Products for sale:</h2>

<style>
  form.search-form {
    display: flex;
    align-items: center;
    border: 1px solid #000;
    padding: 5px 10px;
    border-radius: 20px;
    width: fit-content;
  }

  input[type="search"] {
    border: none;
    margin-left: 10px;
    outline: none;
  }

  button[type="submit"] {
    display: none;
  }

  .search-form i {
    font-size: 1.5em;
  }
</style>

<form action="{{ url_for('products.search') }}" method="get" class="search-form">
  <i class="bi bi-search"></i>
  <input class="form-control" type="search" placeholder="Search products" aria-label="Search" name="query">
</form>

<table class='table table-hover table-bordered container'>
  <thead class="thead-dark">
    <tr>
      <th scope="col">Product ID</th>
      <th scope="col">Product Name</th>
      <th scope="col">Description</th>
      <th scope="col">Type</th>
      <th scope="col">Average Price</th>
      <th scope="col">Image</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products_on_page %}
    <tr>
      <th scope="row">{{ product.id }}</th>
      <td><a href="{{ url_for('sellersProduct.seller_products', product_name=product.name) }}">{{ product.name }}</a></td>
      <td>{{ product.description }}</td>
      <td>{{ product.type }}</td>
      <td>${{ product.avg_price }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<nav aria-label="Page navigation example">
  <ul class="pagination">
    <li class="page-item {% if page == 1 %} disabled {% endif %}"><a class="page-link" href="{{url_for('index.index',page=1)}}">Start</a></li>
    <li class="page-item {% if page == 1 %} disabled {% endif %}"><a class="page-link" href="{{url_for('index.index',page=page-1)}}">Previous</a></li>
    <li class="page-item"><a class="page-link" href="#">{{page}}</a></li>
    <li class="page-item {% if page == max_page %} disabled {% endif %}"><a class="page-link" href="{{url_for('index.index',page=page+1)}}">Next</a></li>
    <li class="page-item {% if page == max_page %} disabled {% endif %}"><a class="page-link" href="{{url_for('index.index',page=max_page)}}">End</a></li>
  </ul>
</nav>

<br><br>
{% if current_user.is_authenticated %}
<form action="{{ url_for('products.k_items') }}" method="get">
  <label for="k">Enter number of top expensive products to display:</label>
  <input type="number" id="k" name="k" min="1" required>
  <input type="submit" value="Submit">
</form>

{% else %}
<p><a href="{{ url_for('users.login') }}">Log in</a> to see your purchase history!</p>
{% endif %}
{% endblock %}
